<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Edit Profile - DirectAdmin Style</title>
        <style>
            :root {
                --primary-blue: #1877f2;
                --light-blue: #e8f0fe;
                --border-color: #e1e4e8;
                --danger: #dc3545;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            }

            body {
                background-color: #f8f9fa;
                min-height: 100vh;
                padding: 40px 20px;
            }

            .container {
                max-width: 800px;
                margin: 0 auto;
            }

            .page-header {
                margin-bottom: 30px;
            }

            .page-title {
                font-size: 24px;
                color: #444;
                font-weight: 500;
                margin-bottom: 8px;
            }

            .page-description {
                color: #666;
                font-size: 14px;
            }

            .form-container {
                background: white;
                border-radius: 8px;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                padding: 30px;
            }

            .form-section {
                margin-bottom: 30px;
            }

            .section-title {
                font-size: 16px;
                color: #444;
                font-weight: 500;
                margin-bottom: 20px;
                padding-bottom: 10px;
                border-bottom: 1px solid var(--border-color);
            }

            .profile-picture-section {
                text-align: center;
                margin-bottom: 30px;
            }

            .profile-picture-label {
                cursor: pointer;
                display: inline-block;
            }

            .profile-picture {
                width: 120px;
                height: 120px;
                border-radius: 50%;
                object-fit: cover;
                border: 3px solid var(--light-blue);
                margin-bottom: 10px;
                transition: opacity 0.2s;
            }

            .profile-picture:hover {
                opacity: 0.9;
            }

            .profile-picture-text {
                color: var(--primary-blue);
                font-size: 14px;
                margin-top: 8px;
            }

            .form-row {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin-bottom: 20px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .form-group label {
                display: block;
                margin-bottom: 8px;
                color: #444;
                font-size: 14px;
                font-weight: 500;
            }

            .form-group input {
                width: 100%;
                padding: 8px 12px;
                border: 1px solid var(--border-color);
                border-radius: 4px;
                font-size: 14px;
                color: #444;
                background: white;
                transition: border-color 0.2s;
            }

            .form-group input:focus {
                outline: none;
                border-color: var(--primary-blue);
            }

            .form-group input[type="file"] {
                display: none;
            }

            .form-actions {
                display: flex;
                gap: 10px;
                justify-content: flex-end;
                margin-top: 30px;
            }

            .btn {
                padding: 8px 16px;
                border-radius: 4px;
                font-size: 14px;
                font-weight: 500;
                text-decoration: none;
                cursor: pointer;
                border: none;
                transition: opacity 0.2s;
            }

            .btn-primary {
                background-color: var(--primary-blue);
                color: white;
            }

            .btn-danger {
                background-color: var(--danger);
                color: white;
            }

            .btn:hover {
                opacity: 0.9;
            }

            .alert {
                padding: 12px;
                border-radius: 4px;
                font-size: 14px;
                margin-bottom: 20px;
            }

            .alert-success {
                background-color: #f1f8e9;
                border: 1px solid #dcedc8;
                color: #33691e;
            }

            .alert-error {
                background-color: #fff2f2;
                border: 1px solid #ffcdd2;
                color: #d32f2f;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="page-header">
                <h1 class="page-title">Edit Profile</h1>
                <p class="page-description">Update your profile information</p>
            </div>

            {% if messages %}
                {% for message in messages %}
                    <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}

            <div class="form-container">
                <form method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <div class="form-section">
                        <h2 class="section-title">Profile Picture</h2>
                        <div class="profile-picture-section">
                            <label for="profile_picture" class="profile-picture-label">
                                {% if user.profile.profile_picture %}
                                    <img id="preview-image" src="{{ user.profile.profile_picture.url }}" alt="Profile Picture" class="profile-picture">
                                {% else %}
                                    <img id="preview-image" src="/static/default-avatar.png" alt="Default Profile Picture" class="profile-picture">
                                {% endif %}
                                <div class="profile-picture-text">Click to change picture</div>
                            </label>
                            <input type="file" id="profile_picture" name="profile_picture" accept="image/*" onchange="previewImage(this);">
                        </div>
                    </div>

                    <div class="form-section">
                        <h2 class="section-title">Personal Information</h2>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="first_name">First Name</label>
                                <input type="text" id="first_name" name="first_name" value="{{ user.first_name }}" required>
                            </div>
                            <div class="form-group">
                                <label for="last_name">Last Name</label>
                                <input type="text" id="last_name" name="last_name" value="{{ user.last_name }}" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" value="{{ user.email }}" required>
                        </div>
                    </div>

                    <div class="form-section">
                        <h2 class="section-title">Contact Information</h2>
                        <div class="form-group">
                            <label for="phone_number">Phone Number</label>
                            <input type="tel" id="phone_number" name="phone_number" value="{{ user.profile.phone_number }}">
                        </div>
                        <div class="form-group">
                            <label for="address">Address</label>
                            <input type="text" id="address" name="address" value="{{ user.profile.address }}">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="city">City</label>
                                <input type="text" id="city" name="city" value="{{ user.profile.city }}">
                            </div>
                            <div class="form-group">
                                <label for="governorate">Governorate</label>
                                <input type="text" id="governorate" name="governorate" value="{{ user.profile.governorate }}">
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <a href="{% url 'profile' %}" class="btn btn-danger">Cancel</a>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>

        <script>
            function previewImage(input) {
                if (input.files && input.files[0]) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('preview-image').src = e.target.result;
                    }
                    reader.readAsDataURL(input.files[0]);
                }
            }
        </script>
    </body>
</html>
